# 1. Необходимое окружение
### ЯП и библиотеки 
Язык реализации python в блокноте Jupyter notebook. Нужно установить если не установлены библиотеки `fastapy` и `numpy`, используя `pip install fastapy numpy`. 
Остальные вроде должны быть установлены изначально это `re`, `pickle`, `heapq`. 

А также необходимо установить Юпитер как это сделать можно узнать по [ссылке](https://habr.com/ru/articles/859812/).

### Файлы данных
Необходимо поместить файла данных `uniprot-choline_esterase_reviewed-yes.fasta` и `uniprot_sprot.fasta` в одну директорию с ноутбуком `analysis.ipynb`.

# 2. Назначение функций
### Функции кодировки
##### 1) `encode(s: str) -> int`
Выполняется кодировка пар букв в числа с пропуском встречающихся неизвестных символов 

##### 2) `get_vect(s: str) -> np.ndarray`
Получаем вектор содержащий количество соседствующих пар букв в конкретном слове.

### Функции построения массивов данных
Все функции построения сохраняют полученный результат в файле "*.pkl", чтобы не выполнять это построение множество раз
##### 1) `build_database(filename: str)`
Выполняет построение базы данных с кодировкой по парам букв для всех белков из файла `filename`

##### 2) `build_id_names(filename: str)`
Строит словарь сопоставляющий каждому белку по его id - его название и вид в формате:

`"Protein: {Name} || Organism: {Organism}"`

### Функции нахождения близких
##### 1) `cosine_similarity(v1: np.ndarray, v2: np.ndarray) -> float`
Считает косинусное расстояние между двумя векторами

##### 2) `find_top_100_similar_sequences(database: list[tuple[str, np.ndarray]], target_sequence: str) -> list[tuple[float, str]]`
Выполняет поиск 100 максимально похожих последовательностей, на вход принимая массив закодированных белков и белок, похожий на который ищем.

Внутри идёт его закодирование, сравнение с остальными по очереди и заполнение кучи, которая автоматически поддерживает порядок по нашему расстоянию.
При достижении размера больше 100 (это 101), последний элемент (с самым маленьким косинусным расстоянием) сбрасывается, 
и поэтому куча всегда содержит не больше 100 лучших исследованных элементов.

В итоге выводятся 100 лучших пар `([косинусное_расстояние], [идентификатор_белка])`

##### 3) `print_names(proteins: list[tuple[float, str]], names)`
Выводит результат в более человекочитаемом виде и с названием белка и вида

# 3. Тестирование
### Простая версия
Просто нужно всё прощёлкать до последнего поля.

А затем необходимо ввести своё значение в последнее поле (своего белка `t=""`) и запустить

Ответ будет дан для большой выборки. 

### Чуть менее простая версия
##### Чтобы обучить свою выборку надо запустить
```filename = "uniprot_sprot.fasta"
build_database(filename)
build_id_names(filename)
```

##### Чтобы подгрузить другую базу данных нашего формата надо запустить
Для данных:
```
with open(f"{filename}_database.pkl", "rb") as f:
    database = pickle.load(f)
```
Для имён:
```
with open(f"{filename}_names.pkl", "rb") as f:
    names = pickle.load(f)
```

##### Чтобы проверить свой белок запустить после этого
```
#your Protein
t = ""
print_names(find_top_100_similar_sequences(database, t), names)
```
